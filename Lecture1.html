<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistical Models and Methods for Health Research - CHIC600</title>
    <meta charset="utf-8" />
    <meta name="author" content="Claudio Fronterre, Lecturer in Biostatistics" />
    <script src="libs/header-attrs-2.10/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
    <script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
    <link rel="stylesheet" href="mtheme.css" type="text/css" />
    <link rel="stylesheet" href="fonts_mtheme.css" type="text/css" />
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# <small>Statistical Models and Methods for Health Research - CHIC600</small>
## Lecture 1
<html>
<div style="float:left">

</div>
<hr color='#324147' size=4px width=800px>
</html>
### Claudio Fronterre, Lecturer in Biostatistics
### <small><br/>CHICAS, Lancaster Medical School</small>
### <br/>13<sup>th</sup> October 2021

---

# Myself

My fields of research:

- spatial and spatio-temporal statistics
- survey design
- real-time health surveillance

Applied research with a focus on the analysis of diseases that afflict low and middle income countries.

---
# Yourself

- Where are you from?
- Why health data science?
- Background studies?
- Favourite TV series?

---
# Organisation

**Timetable**

Wednesday:
- Lecture 9:00 - 11:00 in Geroge Fox LT5
- Tutorial 15:30 - 17:30 in Charles Carter A17

Thursday:
- Lecture 9:00 - 11:00 in Management School Robinson LT16 
- Tutorial 13:00 - 14:30 in Management School LT06

---
# Assessment

**Week 6 - 100% coursework**
- theoretical questions
- interpretation of results
- statistical analysis of real data

---
# .font90[Scientific and Statistical Method]

&lt;img src="science_triangle.png" width="90%" style="display: block; margin: auto;" /&gt;


???
Nature sits at the apex of the triangle; a scientific theory
provides a model of how nature should behave; a scientific experiment
generates data that show how nature actually behaves. Statistical inference
is the bridge between model and data.
---
# .font90[Mathematical vs. Statistical Method]

Mathematical method is .red[deductive]: 
- explicitly stated assumptions `\(\rightarrow\)` logical derivation of consequences.

--

Statistical method is .red[inferential]:
- empirical evidence (data) `\(\rightarrow\)` process that generated the data

The imprecision or uncertainty in the data makes the inferential process fundamentally different from mathematical deduction.

???
The mathematical method is deductive: its concern is
the logical derivation of consequences from explicitly stated assumptions.
Statistical method is inferential: given empirical evidence in the form of
data, its goal is to ask what underlying natural laws could have generated
the data; and it is the imprecision or uncertainty in the data which
makes the inferential process fundamentally different from mathematical
deduction.

---
# Who is this guy?

&lt;img src="isaac.jpeg" width="60%" style="display: block; margin: auto;" /&gt;


---
# Who is this guy?

**Isaac Newton (1643 - 1727)**

&lt;img src="isaac.jpeg" width="60%" style="display: block; margin: auto;" /&gt;

???

Sir Isaac Newton (1642–1727) was one of the great scientific thinkers of his, or any other, age. Amongst his many achievements, he discovered
the ‘laws of motion’ which form the foundation of classical, or ‘Newtonian’ mechanics. Discoveries by twentieth-century physicists, amongst whom the best known to the general public is Albert Einstein (1879–1955), reveal Newton’s laws to be, strictly, approximations, but approximations that for all practical purposes give excellent descriptions of the everyday behaviour of objects moving and interacting with each other.

Newton’s mother wanted him to be a farmer.

---
# Newtonian mechanics

Newton's law states that the vertical distance `\(d\)` traveled in time `\(t\)` by a body initially at rest and falling under the influence of gravity 
is given by
`$$d = \frac{1}{2}gt^2$$`
where `\(g\)` is a constant.

???
Like any scientific law, this equation will only hold under ‘ideal conditions’. The statistical method often comes into its own when dealing with experimental data that, for practical reasons, have to be collected in less-than-ideal conditions, leading to discrepancies between the data and the laws which purport to generate them. 

---
# .font90[An experiment to illustrate Newton's Law]
&lt;br/&gt;
&lt;img src="experiment_newtong.png" width="60%" style="display: block; margin: auto;" /&gt;

???
A steel ball is held by an electromagnet at a vertical distance d above the bench. The value of d can be adjusted and measured against a millimetre scale. A two-way switch is wired to the electromagnet and to a stopwatch so that in one position the electromagnet is on and the stopwatch is off, and in the other the electromagnet is off and the stopwatch is on. A single run of the experiment consists of setting a value for d, releasing the ball by throwing the switch, and recording by a second throw of the switch the time elapsed until the ball hits the bench.

---
# Defining the question


.red[Why] do we want to analyse the data?

- the scientific question influences our choice of statistical model

--

Suppose that the value of the physical constant `\(g\)` were unknown; using a fixed number of runs of the basic experiment, estimate the value of `\(g\)`.

---
# Designing the experiment

.red[What] data do we want to collect?

--

**Two principles**:

--

.red[Validity] `\(\rightarrow\)` the experiment is capable of answering the question of scientific interest.

--

.red[Efficiency] `\(\rightarrow\)` the answer is as precise as possible.

???
The key to both lies in understanding why experimental
results might vary between runs, i.e., in identifying all possible sources of
variation.


---
# Sources of variation

**Two sources of variation:**

.red[Systematic variation]

- it is under the control of the experimenter

.red[Random variation]
- variation due to unpredictable events

--

**Another classification** 

Variation of .red[interest] and .red[extraneous] variation.
- data collection should aim to eliminate extraneous sources
of variation whenever possible.

???
In our experiment, variation due to changing the value of d is of interest,
because it relates to the scientific question, whereas variation due to
reaction time is extraneous. But to a physiologist, the reverse might be true.
In other words, the distinction between systematic and random variation
is an inherent property of an experiment, whereas the distinction between
variation of interest and extraneous variation is context-dependent.

---
# Experimental results

The data reproduced below are the results obtained by one student from 22 experimental runs.

&lt;img src="data_gravity.png" width="70%" style="display: block; margin: auto;" /&gt;

???
Their results are presented in order of increasing d,
rather than in time order; note that they include some pairs of repeated
measurements at the same value of d, called replicates. Replicates allow
us to assess the random variation in the data separately from the system-
atic variation. This is especially important when we do not have a well-
established theoretical law, like (2.1), to describe the anticipated pattern
of the systematic variation in the data.

---
# Exploratory data analysis

- Describe the general pattern of variation in the data

- Look for unexpected features
 - problems in the experiment
 - unanticipated sources of variation
 - recording errors
 - duplicates
 
---
# COVID19 in England

&lt;img src="theg2.png" width="40%" /&gt;&lt;img src="theg1.png" width="40%" /&gt;

&lt;img src="time_trend2.png" width="4800" style="display: block; margin: auto;" /&gt;

---
# Experimental results in graphical form

&lt;img src="Lecture1_files/figure-html/unnamed-chunk-6-1.png" width="50%" style="display: block; margin: auto;" /&gt;

- How would you describe the relationship between distance and time?

- Why did I put time on the y-axis rather than on the x-axis?

---
# Newton's Law

Newton's Law

`$$d = \frac{1}{2}gt^2$$`

we can re-express the law as

`$$t=\sqrt{2d/g}$$`

Why does this re-expression matter?

--

Because the .red[random variation] in the experimental data affects `\(t\)`, not `\(d\)`.

???
The points in our graph (Figure 2.3) can be thought of as randomly perturbed versions of the points on the curve prescribed by (2.2)

---
# Modelling the data

The word .red[model] is widely used in science to mean a mathematical representation of a natural system.

- models are rarely exact representations of nature (some are pretty good approximations)
- the best models are those informed by well-founded scientific theory

---
# Mechanistic vs. Emperical models

.pull-left[
**Empirical** models have the main goal of describing the pattern of a data-set.
]
.pull-right[
**Mechanistic** models aim to encapsulate the underlying scientific
scientific theory.
]

&lt;br/&gt;

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="emp_mech.png" alt="&amp;lt;br/&amp;gt;" width="100%" /&gt;
&lt;p class="caption"&gt;&lt;br/&gt;&lt;/p&gt;
&lt;/div&gt;


Choice between the two modelling strategies usually guided by both the context and the purpose of each application.

---
# First attempt at modelling

In absence of Newton's laws we might be tempted to describe the observed pattern by a straight-line relationship between `\(d\)` and `\(t\)`.

- the slope of this line would quantify the .red[rate] at which `\(t\)` increases with `\(d\)`.

Define `\(x=\sqrt{d}\)` (*input*) and `\(\beta = \sqrt{2/g}\)` and `\(t=y\)` (*output):

`$$y = \beta x$$`
--

&lt;img src="Lecture1_files/figure-html/unnamed-chunk-7-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---
# What is missing?

Is there a discrepancy between theory and data?

--

Our equation `\(y = \beta x\)` suggests that the best-fitting line should pass through the origin.

&lt;img src="Lecture1_files/figure-html/unnamed-chunk-8-1.png" width="40%" style="display: block; margin: auto;" /&gt;

--
What is missing is the intercept, `\(\alpha\)`, that represents the student's average reaction time.

---
# Second attempt at modelling

We extend our model to 
`$$y = \alpha + \beta x$$`

but the point still don't follow exactly a straight line.

--

Repeated measurements of a person’s reaction time show unpredictable,
or .red[random] variation about an average value.

`$$Y = \alpha + \beta x + Z$$`

with `\(Z\)` a .red[random variable], a quantity which varies unpredictably between runs of the basic experiment. 

---
# Summary

**1.** Newton’s law tells us to expect a straight line, or linear
relationship between `\(x\)` and `\(y\)`
`$$y = \beta x$$` 

--

**2** Basic knowledge of physiology tells us to add an average reaction time `\(\alpha\)`
`$$y = \alpha + \beta x$$`

--

**3** The evidence from the data confirms that we need to add a random variable `\(Z\)`
`$$Y = \alpha + \beta x + Z$$`.

--

.center[**How can we use the model to answer the question?**]

---
# Making inferences from data

- .red[Inference]  is the formal process by which statisticians reach conclusions from data.

- Data are one of infinitely many hypothetical datasets that could be obtained by repeating the experiment under identical conditions.

- The underlying truth, the state of nature, remains the same.

.center[**The answer that the statistical method
gives to any scientific question must be couched in terms of uncertainty.
**]

---
# Statistical inference

`\(\rightarrow\)` .red[Parameter estimation] 

`\(\rightarrow\)` .red[Hypothesis testing] 

`\(\rightarrow\)` .red[Prediction] 

---
# Parameter estimation

Using the data to make a best guess at the true value of any parameter in a model.

`$$Y = \alpha + \beta x + Z$$`

Our model has three parameters, `\(\alpha\)`, `\(\beta\)` and the variability in the random term `\(Z\)`.

--

&gt; **Mathematical interpretation**

&gt; `\(\alpha\)` and `\(\beta\)` are the intercept and slope of the line describing the relationship between `\(x\)` and `\(y\)`.

--

&gt; **Scientific interpretation**

&gt; `\(\alpha\)` is the average reaction time and `\(\beta\)` is related to the physical constant `\(g\)` by the equation `\(\beta = \sqrt{2/g}\)`

---
# Estimation techniques

We could obtain a .red[point estimate] of our parameters by fitting a straight line by eye.

--

We need an objective method that yields a unique answer for a given dataset.

--

This method should also provide an honest quantification of the .red[uncertainty] around our point estimate.

--

`\(\rightarrow\)` .red[Ordinary Least Squares] (OLS)

`\(\rightarrow\)` .red[Maximum Likelihood]

---
# Hypothesis testing

Is a particular value reasonably consistent with the data?

**Hypothesis:** `\(g = 981\)`

A .red[test] of this hypothesis leads either to its .red[acceptance] or .red[rejection] according to whether the hypothesized value is or is not reasonably consistent with the data.

---
# Statistical thinking

.red[Design]&lt;br/&gt;
What data should be collected in order to answer a scientific
question?

--

.red[Modelling]&lt;br/&gt;
How can the variation in the data be described mathematically, so that the description:
- is not demonstrably inconsistent with the data
- incorporates the underlying science, to the extent that
this is well understood
- is a simple as possible subject to the above two constraints

--

.red[Inference]&lt;br/&gt;
Given the data and the model, what scientific conclusions can be drawn?


---
# What have we learnt so far?

Graphical presentation of data is almost always useful.

--

Statistical models should:
  - respect the data;
  - respect the underlying science.

--

Transforming the data can help to achieve both goals.

--

The results of a statistical analysis should always be
interpreted in relation to the original scientific question.

---

class: inverse, center, middle

# Data visualisation
&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#324147' size=4px width=800px&gt;&lt;/html&gt; 

---

# EDA

Cannot lead to definitive conclusions 

--

An essential first step in understanding the patterns of variation in a dataset. 

  - detect gross errors in the data
  - suggest suitable models

--

For example, we may know that toxic emissions from industrial activity harm health, but not know the form of the dose-response relationship. 

--

Although numerical summaries are useful visualization is almost always more powerful.

---
# Visualisations gone wrong

.pull-left[

&lt;br\&gt;


&lt;img src="bad1.png" width="969" /&gt;
]

--

&lt;br\&gt;


.pull-right[
![](christmas-cheer.gif)&lt;!-- --&gt;
]

---
# Visualisations gone wrong


&lt;br\&gt;

&lt;img src="bad2.png" width="70%" style="display: block; margin: auto;" /&gt;

---

# Visualisations gone wrong


&lt;br\&gt;

&lt;img src="bad3.png" width="1071" style="display: block; margin: auto;" /&gt;

---
# Visualisations gone wrong


&lt;br\&gt;

&lt;img src="bad4.png" width="1076" style="display: block; margin: auto;" /&gt;

---


# Visualisations gone wron


&lt;br\&gt;

&lt;img src="bad5.png" width="60%" style="display: block; margin: auto;" /&gt;

---

# Visualisations gone wron



&lt;img src="bad6.png" width="747" style="display: block; margin: auto;" /&gt;


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
